<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE server>
<!-- $Id: extraca-service.xml,v 1.1 2006-07-31 13:13:11 herrvendil Exp $ -->

<server>

  <classpath codebase="." archives="exracaservice.jar"/>

  <!-- ==================================================================== -->
  <!-- RACAService Connection Service                                         -->
  <!-- ==================================================================== -->

  <mbean code="org.ejbca.extra.caservice.jboss.ExtRACAService"
         name="user:service=ExtRACAService">
      
    <!--    Polltime indicating how often the service will run.
            The variable can have the following values:           
            DAILY     =  Every midnight
            HOURLY    =  At XX:00 every hour.
            30MIN     =  At XX:30 and XX:00 every hour
            15MIN     =  At XX:15, XX:30, XX:45,XX:00, every hour 
            1MIN      =  Every minute
            30SEC     =  Every 30 seconds
            15SEC     =  Every 15 seconds
            10SEC     =  Every 10 seconds
            5SEC      =  Every 5 seconds
            1SEC      =  Every second
      -->     
   <attribute name="Polltime">5SEC</attribute>

   <!--
         RACAServiceName is name displayname of the service i jboss.
     -->
   <attribute name="RACAServiceName">ExtRACAService</attribute>

   <!--
         RACAProcessClassPath is the classpath of the RACAProcess to use.
     -->
   <attribute name="RACAProcessClassPath">org.ejbca.extra.caservice.ExtRACAProcess</attribute>

   <!--
         SessionFactoryContext is the context to the hibernite session factory in JBoss.
     -->
   <attribute name="SessionFactoryContext">java:/hibernate/RAMessageSessionFactory</attribute>

   <!--
        Flag to indicate if encrypted messages is required
     -->
   <attribute name="EncryptionRequired">false</attribute>

   <!--
        Flag to indicate if signed messages is required
     -->
   <attribute name="SignatureRequired">false</attribute>

   <!--
       Path to key store used to sign and encrypt messages.
     -->
   <attribute name="KeyStorePath">@jboss.conf.dir@/keystore/extrakeystore.p12</attribute>

   <!--
       Password to unlock key store used to sign and encrypt messages.
     -->
   <attribute name="KeyStorePassword">foo123</attribute>

   <!--
       CA Name of the CA issuing RA Certificates, used to check the validity of RA signatures.
     -->
   <attribute name="RAIssuer">AdminCA1</attribute>

   <depends>jboss.j2ee:module=ejbca-ejb.jar,service=EjbModule</depends>
   <depends>jboss.j2ee:service=EARDeployment,url='ejbca.ear'</depends>
   <!--
   <depends>jboss.j2ee:service=EJB,jndiName=RSASignSession</depends>
   <depends>jboss.j2ee:service=EJB,jndiName=AuthorizationSession</depends>
   <depends>jboss.j2ee:service=EJB,jndiName=CertificateStoreSession</depends>
   <depends>jboss.j2ee:service=EJB,jndiName=UserAdminSession</depends>
   <depends>jboss.j2ee:service=EJB,jndiName=LogSession</depends>   
   <depends>jboss.j2ee:service=EJB,jndiName=CAAdminSession</depends>
   <depends>jboss.j2ee:service=EJB,jndiName=RaAdminSession</depends> 
   <depends>jboss.j2ee:service=EJB,jndiName=GlobalConfigurationDataLocal</depends>     
   <depends>jboss.j2ee:service=EJB,jndiName=KeyRecoverySession</depends> -->
   <depends>jboss.jca:service=LocalTxCM,name=RAMessageDS</depends>   
   <depends>jboss.har:service=HibernateRA</depends>       
  </mbean>

</server>
