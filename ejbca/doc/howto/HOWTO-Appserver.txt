
CONFIGURING Weblogic
====================

Note: EJBCA should work fine with Weblogic 7.x/8.x

1. Edit ejbca.properties, it's important to at least set up the database parameters.
Make special note to:
datasource.jndi-name-prefix - which is specific for Weblogic.
weblogic-oracle-columntype - which is specific for Weblogic.

If you had issued an 'ant' command before, it is now important to do 'ant clean' before building again.

Also edit bin/cli.xml and remove the comments for the two weblogic lines.

2. If you are using Oracle go into file src/java/se/anatom/ejbca/log/LogEntryDataBean.java and change
a line above the method 'getComment()' according to the documentation there.

3. Create EjbcaPool and EjbcaDS in Weblogic. In the database configured for EjbcaPool and EjbcaDS in Weblogic, 
create tables. 
- You can do an 'ant bootstrap' to JBoss if you want JBoss to create the tables for you.

See the file create-tables-ejbca3.sql for table definitions.

4. Set the environment variable WEBLOGIC_HOME pointing to for example /bea/weblogic81 
(weblogic.jar is located under WEBLOGIC_HOME/server/lib).

5. Unforturnately you must also point JBOSS_HOME to where JBoss is located in order for the build 
script to work, at least until someone provides a weblogic.xml corresponding to bin/jboss.xml.

6. Deploy the ear file in weblogic, it should works straight away.

7. Edit 'jndi.properties' in the directories 'ejbca/bin' and 'ejbca/src/java' to
call Weblogic instead of JBoss, modify the principal and credentials according to you weblogic 
domain's setting (same as the user name/password to login weblogic console).

8. Run 'ant install' to do the installation.

9. Run 'ant test:run' to test the setup.

10. Configure SSL in Weblogic, it should require client certificates and trust the initial CA installed 
when doing 'ant install', you can get the cert with 'bin/ejbca.sh ca getrootcert cert.pem'.
This should make the admin-GUI work, but it haven't been verified by anyone yet...

JBOSS
=====

JBoss commonly have problems with class loading if several applications are run in one instance of JBoss.
This will typically manifest itself as ClassCast-, IllegalAccess- or VerifyError Exceptions. 
The reason is usually that mora than one application is using an external jar file, for example commons-fileupload.jar
or ldap.jar, possibly using different versions as well.

These links describe how to configure jboss-app.xml, etc and also describe how
JBoss classloading works.

http://wiki.jboss.org/wiki/Wiki.jsp?page=ClassLoadingConfiguration
http://wiki.jboss.org/wiki/Wiki.jsp?page=JBossClassLoadingUseCases
