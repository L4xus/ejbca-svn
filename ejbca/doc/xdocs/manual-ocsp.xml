<?xml version="1.0"?>
<document>

  <properties>
    <title>OCSP User Guide</title>
  </properties>

<body>

  <section name="OCSP client">
    <p>
This section describes how to build and use the stand alone OCSP and Lookup server client.
</p>
<subsection name="Building the OCSP/Lookup client">
  <p>Using the client toolbox of EJBCA you can easily have a stand alone OCSP client.
  See <a href="manual.html#EJBCA%20client%20toolbox">EJBCA client toolbox</a> for instructions how to build and use the client toolbox.
  </p>
</subsection>
<subsection name="Using the API">
<p>
The best way to learn the API is by looking at the source code, since it is included. The client API is in the class 
org.ejbca.core.protocol.ocsp.OCSPUnidClient.
The command line client can serve as a good sample for using the API and it is in the class
org.ejbca.ui.cli.Ocsp.
</p>
</subsection>
<subsection name="Fnr-Unid mapping">
<p>
For the Unid Lookup part, you must use https with a client certificate with the ocsp client. If you use http with a client certificate
and the OCSP responder is set up to answer Lookup requests, the OCSP client will returns the Fnr. The Fnr will be returned if the certificate 
contains a Unid in the SN component of the SubjectDN, and the Unid has a valid mapping to an Fnr in the OCSP responders Fnr-Unid mapping database.
</p><p>
If the Fnr returned is null, there are several possible errors:
<ol>
<li>The client was not authorized to request an Fnr.</li>
<li>There was no Unid Fnr mapping available.</li>
<li>There was no Unid in the certificate (serialNumber DN component).</li>
</ol>
    </p>
</subsection>
  </section>

  <section name="OCSP stress testing">
  <p>Using the client toolbox of EJBCA you can easily stress test your CAs and OCSP responders.
  See <a href="manual.html#EJBCA%20client%20toolbox">EJBCA client toolbox</a> for instructions how to build and use the client toolbox.
  </p>
  <p>To stress test you can first issue a large number of certificates from the CA using the webservice stress test, and after this
  stress test the OCSP responder with a random selection of all the certificates issued.
  </p>
  <source>
cd clientToolBox-dist
./ejbcaClientToolBox.sh EjbcaWsRaCli stress ...
./ejbcaClientToolBox.sh OCSP stress ...
  </source>
  </section>

</body>
</document>

