Set up Oracle as database for EJBCA in JBoss
============================================

NOTE:

The default database HypersoniqDB should be removed completely.
The section "JBossCX setup" must be edited for this.


NOW ON TO THE HOWTO!

Configuring EJBCA
-----------------

1. Rename src/ca/META-INF/jaws-oracle.xml to jaws.xml.
   Make sure src/ca/META-INF/jaws.xml contains entries to set the correct type-
   mappings
   for 'b64cert' and 'b64crl' for Oracle.

2. Build with 'ant' and deploy with 'deploy.sh/cmd'.

Configuring JBoss
-----------------

Configuration files in JBoss is located in the jboss/conf/Tomcat or Jetty
directory.

1. Setup Oracle and Create Database for ejbca, eg: ejbca

2. Put JDBC driver for Oracle, classes12.zip, in jboss/lib/ext.

THE DESCRIPTION BELOW IS FOR JBOSS 2.4.x, FOR JBOSS 3.x PLEASE SEE OFFICIAL
DOCS.

4. Edit jboss.jcml.

The JDBC section should look something like:

     <!-- =================================================================-->
     <!-- JDBC-->
     <!-- =================================================================-->

     <mbean code="org.jboss.jdbc.JdbcProvider" name="DefaultDomain:service=
     JdbcProvider">
          <attribute name="Drivers">
          oracle.jdbc.driver.OracleDriver,org.hsqldb.jdbcDriver</attribute>
     </mbean>

     <mbean code="org.jboss.jdbc.XADataSourceLoader"
     name="DefaultDomain:service=XADataSource,name=DefaultDS">
       <attribute name="PoolName">DefaultDS</attribute>
       <attribute name="DataSourceClass">
       org.jboss.pool.jdbc.xa.wrapper.XADataSourceImpl</attribute>
       <attribute name="Properties"></attribute>
       <attribute name="URL">jdbc:oracle:thin:@<ip>:<port>:<db></attribute>
       <attribute name="JDBCUser">user</attribute>
       <attribute name="Password">yourpassword</attribute>
       <attribute name="MaxSize">25</attribute>
       <attribute name="MinSize">1</attribute>
       <attribute name="IdleTimeout">1800000</attribute>
       <attribute name="IdleTimeoutEnabled">true</attribute>
       <attribute name="MaxIdleTimeoutPercent">1.0</attribute>
     </mbean>

6. Edit standardjaws.xml. Change the default type-mapping to Oracle. (Config
JBoss to create primary key in db if you like, see
http://www.jboss.org/online-manual/HTML/ch06s03.html)

     <type-mapping>Oracle8</type-mapping>

7. DONE! Start JBoss. Run all tests with 'runtest.sh/cmd'.
   Use your favorite Oracle graphic editor to look at the beautiful tables.


