HOWTO set up mySQL as database in JBoss
---------------------------------------

NOTE: This document is work in progress. So far it only describes how to set
up mySQL as DefaultDS. The default database HypersoniqDB should also be
removed completely. The section "JBossCX setup" must probably be edited for
this...
Also transactionsupport in mySQL should be described.

NOTE2: For the time beeing, mySQL does not work (with the config below) since
it uses 'VARCHAR(255) BINARY' as mapping form String, and my Strings
(b64cert etc) are longer than 255 chars.

NOTE3: Obviously, String maps to VARCHAR and according to mySQL docs:
Values in VARCHAR columns are variable-length strings. You can declare a
VARCHAR column to be any length between 1 and 255, just as for CHAR columns.
However, in contrast to CHAR, VARCHAR values are stored using only as many
characters as are needed, plus one byte to record the length. Values are not
padded; instead, trailing spaces are removed when values are stored. 
(This space removal differs from the ANSI SQL specification.)

For longer fields, a BLOB should be used with mySQL I think...
example
<entity>
<ejb-name>Scanning</ejb-name>
<cmp-field>
<field-name>name</field-name>
<column-name>name</column-name>
<jdbc-type>VARCHAR</jdbc-type>
<sql-type>VARCHAR(20)</sql-type>
</cmp-field>
<cmp-field>
<field-name>scanningValueObj</field-name>
<column-name>scanningValueObj</column-name>
<jdbc-type>JAVA_OBJECT</jdbc-type>
<sql-type>MEDIUMBLOB</sql-type>
</cmp-field>
</entity>

-----
Now on to the howto:

1. Download and install mySQL.

2. Download JDBC driver for mySQL from http://mmmysql.sourceforge.net/

3. Put mm.mysql-<version>-bin.jar in jboss/lib/ext.

4. Edit jboss.jcml. org.gjt.mm.mysql.Driver must be inluded as driver and
mySQL set up as DefaultDS.

The JDBC section should look something like:

<!-- =================================================================-->
<!-- JDBC-->
<!-- =================================================================-->

<mbean code="org.jboss.jdbc.JdbcProvider" name="DefaultDomain:service=JdbcProvider">
     <attribute name="Drivers">org.gjt.mm.mysql.Driver,org.hsqldb.jdbcDriver</attribute>
</mbean>

<mbean code="org.jboss.jdbc.XADataSourceLoader" name="DefaultDomain:service=XADataSource,name=DefaultDS">
  <attribute name="PoolName">DefaultDS</attribute>
  <attribute name="DataSourceClass">org.jboss.pool.jdbc.xa.wrapper.XADataSourceImpl</attribute>
  <attribute name="Properties"></attribute>
  <attribute name="URL">jdbc:mysql://localhost/ejbca</attribute>
  <attribute name="JDBCUser">root</attribute>
  <attribute name="Password" />
</mbean>

5. Edit standardjaws.xml. Change typ-mapping to mySQL.

<type-mapping>mySQL</type-mapping>

6. DONE! Start JBoss. Use your favorite mySQL graphic editor to look at the beautiful tables.

